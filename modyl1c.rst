Модуль интеграции с сервисом SMS через 1с
=========================================

Для использования данного вида интеграции вам необходимо зарегистрироваться на серверной платформе кампании, либо через менеджера компании. При регистрации вы получите логин и пароль, а так же стандартное имя отправителя **DTSMS**, которое необходимо будет поменять, запросив другое в ЛК.

.. warning:: Внимание! Для использования данного вида интеграции необходимо обратиться к своему менеджеру, либо в техническую поддержку support@devinotele.com для настройки доступа.

`Скачать модуль <https://github.com/devinotelecom/docs/blob/master/examples/SMS-1C.zip>`_

Модуль 1с работает только с версиями 8.1, 8.2, 8.3

Установка интеграционного модуля в 1С
-------------------------------------

Чтобы пользоваться интеграционным модулем (далее ИМ) для 1С, необходимо открыть его через 1С. Для этого во вкладке «Файл», необходимо выбрать пункт выпадающего меню «открыть».

.. image:: /img/06.jpg

Затем, выбрать путь до ИМ на вашем компьютере

.. image:: /img/2.jpg

После чего, в 1С, откроется ИМ.

Авторизация в интеграционном модуле
-----------------------------------

Для того чтобы отправлять сообщения через 1С, необходимо во вкладке «Настройка» ввести ваши личные данные: *логин и пароль*, а так же имя отправителя (отличное от testsms), зарегистрированное в личном кабинете. Адрес сервера вписан в обработку изначально:

.. code-block:: json

    https://integrationapi.net/rest
    

.. image:: /img/3.jpg

Для проверки правильности ввода данных, нажмите кнопку обновления баланса, если логин с паролем введены правильно, то Вы увидите свой баланс.

.. image:: /img/55.jpg

Если данные, для подключения введены неверно, то появится ошибка: Result: **Error_Invalid_Login.**

Единичная отправка сообщений
----------------------------

Мгновенная отправка единичного сообщения
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Для отправки одного сообщения следует выбрать вкладку «Тестовая отправка».
В поле «Отправитель» выбрать имя отправителя, из списка, который вы вводили во вкладке «Настройки» (все имена отправителей должны быть зарегистрированы в личном кабинете). В поле текст SMS, введите текст отправляемого сообщения. Номер получателя – номер, на который вы хотите отправить SMS (в формате 79214563763).

.. image:: /img/4.jpg

После отправки сообщения (если все параметры введены правильно), появится диалоговое окно, с ID, отправленного сообщения, который запишется в поле «ID последнего SMS».

.. image:: /img/22.jpg

Чтобы узнать статус отправленного сообщения, следует нажать кнопку «Уточнить статус».

.. image:: /img/6.jpg

В появившемся окне, будет информация о времени отправки сообщения и его статусе (сообщения, ID, которого записано в поле «ID последнего SMS»).

.. image:: /img/7.jpg


Отправка отложенного по времени единичного сообщения 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Чтобы задать конкретные дату и время отправки единичного сообщение, необходимо перед отправкой выбрать «Отложить до» и дату, время отправки сообщения.

.. image:: /img/8.jpg


Пакетная отправка сообщений
---------------------------

С помощью данного модуля для 1С, возможно осуществлять рассылку множеству получателей.

Создание списка получателей сообщений.
Для массовой рассылки сообщений, необходимо во вкладке «База абонентов» добавить контакты для рассылки.

.. image:: /img/9.jpg

Это можно сделать разными способами: 

* Добавлять единичные контакты

.. image:: /img/11.jpg

* Заполнять номерами из базы (добавить контакты из справочника контрагентов)

.. image:: /img/12.jpg

* Загружать из xls (xlsx) файла

.. image:: /img/12.jpg

При выборе данного типа загрузки, в открывшимся окне, будет предложено выбрать параметры для загрузки базы абонентов из файла. Здесь нужно выставить соответствие между колонками в xls-файле и наименованиями (телефон, имя адресата) в модуле.

.. image:: /img/13.jpg

Так же, если во время работы с уже загруженной базой она будет изменена, есть возможность сохранить базу в формате xls.

.. image:: /img/14.jpg


Мгновенная отправка сообщений
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

После того, как списки получателей сообщений сформированы, во вкладке «Отправка», следует выбрать вкладку «Массовая рассылка».
В поле «Отправитель» выбрать имя отправителя, из списка, который вы вводили во вкладке «Настройки» (все имена отправителей должны быть зарегистрированы в личном кабинете).
В поле текст SMS, вводите текст отправляемого сообщения.

.. image:: /img/15.jpg

После нажатия кнопки «Отправить», модуль подсчитает стоимость рассылки, и предупредит о том, какой баланс у Вас будет после осуществления рассылки SMS.

.. image:: /img/16.jpg

После удачной отправки сообщений, в служебных сообщениях появятся ID, отправленных сообщений, и их количество. (В случае, если некоторые данные были заполнены неверно вернется один из статусов операций, который можно посмотреть ниже)

.. image:: /img/17.jpg


Пакетная отправка отложенных по времени сообщений
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Для того, чтобы создать пакетную отложенную отправку сообщений, следует, перед оправкой, выбрать дату и время, начиная с которого будет осуществляться рассылка.

.. image:: /img/18.jpg

Статусы операций и сообщений
----------------------------

    Статусы операций
+-----------------------------------+--------------------------------------------------+
| Статусы                           | Значение                                         |
+===================================+==================================================+
| OK_Operation_Completed            | Операция выполнена                               |
+-----------------------------------+--------------------------------------------------+
| Error_Not_Enough_Credits          | Ошибка: недостаточно кредитов                    |
+-----------------------------------+--------------------------------------------------+
| Error_Message_Rejected            | Ошибка: сообщение отклонено                      |
+-----------------------------------+--------------------------------------------------+
| Error_Invalid_Source_Address      | Ошибка: некорректный адрес отправителя сообщения |
+-----------------------------------+--------------------------------------------------+
| Error_Invalid_Destination_Address | Ошибка: некорректный номер получателя сообщения  |
+-----------------------------------+--------------------------------------------------+
| Error_SMS_User_Disabled           | Ошибка: СМС - пользователь заблокирован          |
+-----------------------------------+--------------------------------------------------+
| Error_Invalid_MessageID           | Ошибка: некорректный идентификатор сообщения     |
+-----------------------------------+--------------------------------------------------+
| Error_Invalid_Header              | Ошибка: некорректно переданы параметры           |
+-----------------------------------+--------------------------------------------------+
| Error_Invalid_Login               | Ошибка: неправильный логин                       |
+-----------------------------------+--------------------------------------------------+
| Error_Invalid_Password            | Ошибка: неправильный пароль                      |
+-----------------------------------+--------------------------------------------------+
| Error_Unauthorised_IP_Address     | Ошибка: не авторизованный IP-адрес               |
+-----------------------------------+--------------------------------------------------+
| Error_SMS_User_Not_Activated      | Ошибка: СМС - пользователь не активирован        |
+-----------------------------------+--------------------------------------------------+
| Error_Message_Queue_Full          | Ошибка: очередь сообщений полна                  |
+-----------------------------------+--------------------------------------------------+
| Error_Gateway_Offline             | Ошибка: сервер недоступен                        |
+-----------------------------------+--------------------------------------------------+
| Error_Gateway_Busy                | Ошибка: сервер занят другим запросом             |
+-----------------------------------+--------------------------------------------------+
| Error_Database_Offline            | Ошибка: сервер базы данных недоступен            |
+-----------------------------------+--------------------------------------------------+

    Статусы сообщений
+------------------------------------+-------------------------------------------------+
|  Статусы                           | Значение                                        |
+====================================+=================================================+
| Enqueued                           | Ожидает отправки                                |
+------------------------------------+-------------------------------------------------+
| Delivered_To_Gateway               | Отправлено                                      |
+------------------------------------+-------------------------------------------------+
| Sent                               | Отправлено                                      |
+------------------------------------+-------------------------------------------------+
| Delivered_To_Recipient             | Доставлено                                      |
+------------------------------------+-------------------------------------------------+
| Error_Invalid_Destination_Address  | Ошибка: некорректный номер получателя сообщения |
+------------------------------------+-------------------------------------------------+
| Error_Invalid_Source_Address       | Ошибка: некорректный адрес отправителя сообщения|
+------------------------------------+-------------------------------------------------+
| Error_Rejected                     | Ошибка: сообщение отклонено                     |
+------------------------------------+-------------------------------------------------+
| Error_Expired                      | Ошибка: истек срок жизни сообщения              |
+------------------------------------+-------------------------------------------------+
| Все остальное                      | Статус не распознан                             |
+------------------------------------+-------------------------------------------------+

Статусы передаются на русском языке, в случае служебных запросов могут быть на английском.
